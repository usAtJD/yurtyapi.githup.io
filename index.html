# File structure for GitHub-ready Flask app:
#
# yurt_yapi_panel/
# ├── app.py
# ├── requirements.txt
# ├── uploads/                (auto-created)
# └── templates/
#     └── index.html

# ===================== app.py =====================
from flask import Flask, render_template, request, redirect, url_for, send_from_directory
from werkzeug.utils import secure_filename
import os
import urllib.parse

app = Flask(__name__)
app.secret_key = 'yurtyapi25885'
UPLOAD_FOLDER = 'uploads'
app.config['UPLOAD_FOLDER'] = UPLOAD_FOLDER
app.config['MAX_CONTENT_LENGTH'] = 600 * 1024 * 1024  # 600 MB

os.makedirs(UPLOAD_FOLDER, exist_ok=True)

company_info = {
    "name": "YURT YAPI ALEMİNYUM SİSTEMLERİ",
    "phone": "+905353133790",
    "email": "info@yurtyapialeminyum.com",
    "founder": "İSMAİL YEŞİLYURT",
    "website": "https://yurtyapialuminyum.com/",
    "address": "İnönü mahallesi 361 sk no 48 BAĞCILAR / İSTANBUL"
}

@app.route('/')
def index():
    files = os.listdir(UPLOAD_FOLDER)

    vcard = (
        "BEGIN:VCARD\nVERSION:3.0\n"
        f"N:{company_info['name']}\n"
        f"TEL:{company_info['phone']}\n"
        f"EMAIL:{company_info['email']}\n"
        f"URL:{company_info['website']}\n"
        f"ADR:{company_info['address']}\n"
        f"NOTE:Kurucu: {company_info['founder']}\n"
        "END:VCARD"
    )
    vcard_encoded = "data:text/vcard;charset=utf-8," + urllib.parse.quote(vcard)

    return render_template('index.html', company=company_info, files=files, vcard_link=vcard_encoded)

@app.route('/upload', methods=['POST'])
def upload_file():
    if 'file' not in request.files:
        return redirect(url_for('index'))

    file = request.files['file']
    if file.filename == '':
        return redirect(url_for('index'))

    filename = secure_filename(file.filename)
    file.save(os.path.join(UPLOAD_FOLDER, filename))
    return redirect(url_for('index'))

@app.route('/download/<filename>')
def download_file(filename):
    return send_from_directory(UPLOAD_FOLDER, filename, as_attachment=True)

@app.route('/delete/<filename>', methods=['POST'])
def delete_file(filename):
    filepath = os.path.join(UPLOAD_FOLDER, filename)
    if os.path.exists(filepath):
        os.remove(filepath)
    return redirect(url_for('index'))

if __name__ == '__main__':
    app.run(debug=True)

# ===================== templates/index.html =====================
# Place this file in a folder named "templates"

<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>YURT YAPI ALEMİNYUM SİSTEMLERİ</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 0; background: #f0f2f5; }
    header { background: #2c3e50; color: white; padding: 2rem; text-align: center; }
    .container { max-width: 800px; margin: auto; padding: 2rem; }
    .card { background: white; padding: 1.5rem; border-radius: 10px; box-shadow: 0 4px 8px rgba(0,0,0,0.1); margin-bottom: 2rem; }
    .btn { display: inline-block; margin-top: 1rem; padding: 10px 16px; background-color: #3498db; color: white; border-radius: 5px; text-decoration: none; cursor: pointer; }
    .btn.delete { background-color: #e74c3c; }
    ul { list-style: none; padding: 0; }
    li { margin-bottom: 0.75rem; display: flex; justify-content: space-between; align-items: center; }
  </style>
</head>
<body>
  <header>
    <h1>{{ company.name }}</h1>
  </header>
  <div class="container">
    <div class="card">
      <h2>İletişim Bilgileri</h2>
      <p><strong>Telefon:</strong> <a href="tel:{{ company.phone }}">{{ company.phone }}</a></p>
      <p><strong>E-Posta:</strong> <a href="mailto:{{ company.email }}">{{ company.email }}</a></p>
      <p><strong>Adres:</strong> {{ company.address }}</p>
      <a href="{{ vcard_link }}" download="yurt_yapi.vcf" class="btn">Rehbere Ekle</a>
    </div>

    <div class="card">
      <h2>Dosya Yöneticisi</h2>
      <form action="/upload" method="POST" enctype="multipart/form-data">
        <input type="file" name="file" required>
        <button type="submit" class="btn">Dosya Yükle</button>
      </form>

      <ul>
        {% for file in files %}
        <li>
          <span>{{ file }}</span>
          <span>
            <a href="/download/{{ file }}" class="btn">İndir</a>
            <form action="/delete/{{ file }}" method="POST" style="display:inline;">
              <button type="submit" class="btn delete" onclick="return confirm('Dosyayı silmek istediğinizden emin misiniz?');">Sil</button>
            </form>
          </span>
        </li>
        {% else %}
        <li>Henüz dosya yok.</li>
        {% endfor %}
      </ul>
    </div>
  </div>
</body>
</html>

# ===================== requirements.txt =====================
# Flask uygulaması için gerekli kütüphaneler
Flask
Werkzeug
